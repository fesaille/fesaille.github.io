


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://github.com/fesaille/_nb/%3DPy/02_SQL/03_Postgres/">
      
      
        <meta name="author" content="Emmmanuel Roux">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.1.0">
    
    
      
        <title>03 Postgres - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../_css/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
      <link rel="stylesheet" href="../../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../../css/pandas-dataframe.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="lime">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#initialisation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://github.com/fesaille" title="My Docs" class="md-header-nav__button md-logo" aria-label="My Docs">
      
  <img src="../../../../images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            My Docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              03 Postgres
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../../.." class="md-tabs__link md-tabs__link--active">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../shell/intro/" class="md-tabs__link">
          Linux
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../01_Python/01%20-%20Python%20-%20CPython%20design/" class="md-tabs__link">
          Python
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../go/concurency/" class="md-tabs__link">
          Go
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../devops/ansible/" class="md-tabs__link">
          DevOps
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../DB/intro/" class="md-tabs__link">
          DB
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../data/_intro/" class="md-tabs__link">
          Data
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../Viz/matplotlib/" class="md-tabs__link">
          Visualization
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../WebDev/Intro/" class="md-tabs__link">
          WebDev
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../doc/md/" class="md-tabs__link">
          ?
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://github.com/fesaille" title="My Docs" class="md-nav__button md-logo" aria-label="My Docs">
      
  <img src="../../../../images/logo.svg" alt="logo">

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Linux
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Linux" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/intro/" title="shell" class="md-nav__link">
      shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/zsh/" title="zsh" class="md-nav__link">
      zsh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      GNU
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="GNU" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        GNU
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/GNU/Intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/GNU/Makefile/" title="Makefile" class="md-nav__link">
      Makefile
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      vim
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="vim" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        vim
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vim/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vim/panes/" title="Panes" class="md-nav__link">
      Panes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vim/edition/" title="Edition" class="md-nav__link">
      Edition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vim/motion/" title="Motion" class="md-nav__link">
      Motion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vim/plugins/" title="Plugins" class="md-nav__link">
      Plugins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vim/languages/" title="Language support" class="md-nav__link">
      Language support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/fzf/" title="fzf" class="md-nav__link">
      fzf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/git/" title="git" class="md-nav__link">
      git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../linux/network/" title="network" class="md-nav__link">
      network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8">
    
    <label class="md-nav__link" for="nav-2-8">
      Ubuntu
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Ubuntu" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Ubuntu
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/Ubuntu/configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/Ubuntu/python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/sys/" title="helpers" class="md-nav__link">
      helpers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/vm/" title="Virtualization" class="md-nav__link">
      Virtualization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Python
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Python" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../01_Python/01%20-%20Python%20-%20CPython%20design/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Python/typing/" title="Typing" class="md-nav__link">
      Typing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Python/envs/" title="Envs" class="md-nav__link">
      Envs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Python/IterGen/" title="Iterators, generators and coroutines" class="md-nav__link">
      Iterators, generators and coroutines
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Python/test/" title="Tests" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../shell/Ubuntu/python/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Go
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Go" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Go
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../go/concurency/" title="Concurency" class="md-nav__link">
      Concurency
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      DevOps
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="DevOps" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        DevOps
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../devops/ansible/" title="Ansible" class="md-nav__link">
      Ansible
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../devops/cicd/" title="CI/CD" class="md-nav__link">
      CI/CD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../devops/codecov/" title="Code coverage" class="md-nav__link">
      Code coverage
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      DB
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="DB" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        DB
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../DB/intro/" title="intro" class="md-nav__link">
      intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      MongoDB
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="MongoDB" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        MongoDB
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../DB/mongoDB/_intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../DB/mongoDB/Aggregation/" title="Aggregation framework" class="md-nav__link">
      Aggregation framework
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      SQL
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="SQL" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        SQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../DB/SQL/_intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../DB/SQL/postgres/" title="PostgreSQL" class="md-nav__link">
      PostgreSQL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Object store
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Object store" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Object store
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../DB/S3/_intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Data
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Data" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../data/_intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      ndarray
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="ndarray" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        ndarray
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ndarray/intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Time series
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Time series" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Time series
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../data/timeseries/_intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../data/timeseries/features/" title="Features selection" class="md-nav__link">
      Features selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../data/timeseries/matrixprofile/" title="Matrix profile" class="md-nav__link">
      Matrix profile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../data/windowing/" title="Windowing" class="md-nav__link">
      Windowing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-4" type="checkbox" id="nav-7-4">
    
    <label class="md-nav__link" for="nav-7-4">
      Machine Learning
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Machine Learning" data-md-level="2">
      <label class="md-nav__title" for="nav-7-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Machine Learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ml/regression/" title="Regression" class="md-nav__link">
      Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ml/dl/" title="Time series" class="md-nav__link">
      Time series
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Visualization
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Visualization" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Visualization
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Viz/matplotlib/" title="Matplolib" class="md-nav__link">
      Matplolib
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      WebDev
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="WebDev" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        WebDev
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../WebDev/Intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../WebDev/css/" title="CSS" class="md-nav__link">
      CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../WebDev/node/" title="node" class="md-nav__link">
      node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../WebDev/REACT/" title="REACT" class="md-nav__link">
      REACT
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      ?
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="?" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        ?
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../doc/md/" title="Help" class="md-nav__link">
      Help
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Tutorials:
- http://www.postgresqltutorial.com/
- https://www.postgresql.org/docs/11/tutorial-sql.html</p>
<p>Postgres jupyter kernel: https://github.com/bgschiller/postgres_kernel
</div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
pgspecial must be installed for running special command postgres command in this notebook
</div>
</div></p>
</div>
<p>%pip install pgspecial
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Use <code>sqlmagic</code> and set sqlmagic compatible uri
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">sql</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre>The sql extension is already loaded. To reload it, use:
  %reload_ext sql
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="initialisation">Initialisation<a class="headerlink" href="#initialisation" title="Permanent link">&para;</a></h1>
<p></div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;postgresql+psycopg2://postgres:postgres@db.postgres.app.com&quot;</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">sql</span> <span class="p">{</span><span class="n">uri</span><span class="p">}</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&#39;Connected: postgres@None&#39;</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
SQL for table deletion and creation
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">sql</span> <span class="n">select</span> <span class="n">current_database</span><span class="p">()</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
1 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>current_database</th>
    </tr>
    <tr>
        <td>postgres</td>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pg_tables</span>
<span class="n">WHERE</span> <span class="n">schemaname</span> <span class="n">NOT</span> <span class="n">IN</span> <span class="p">(</span><span class="s1">&#39;pg_catalog&#39;</span><span class="p">,</span> <span class="s1">&#39;information_schema&#39;</span><span class="p">);</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
1 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>schemaname</th>
        <th>tablename</th>
        <th>tableowner</th>
        <th>tablespace</th>
        <th>hasindexes</th>
        <th>hasrules</th>
        <th>hastriggers</th>
        <th>rowsecurity</th>
    </tr>
    <tr>
        <td>public</td>
        <td>country</td>
        <td>postgres</td>
        <td>None</td>
        <td>True</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">Person</span><span class="p">;</span>
<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">Country</span><span class="p">;</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
Done.
Done.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="create-table">Create table<a class="headerlink" href="#create-table" title="Permanent link">&para;</a></h1>
<p></div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
<strong>Primary key</strong>, auto-increment (see <a href="https://chartio.com/resources/tutorials/how-to-define-an-auto-increment-primary-key-in-postgresql/">post</a>):
- usage of the SERIAL or BIGSERIAL data types when CREATING a new table.
- creating a custom SEQUENCE
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">Country</span> <span class="p">(</span>
    <span class="n">country_id</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
    <span class="n">country_name</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">Person</span> <span class="p">(</span>
    <span class="n">person_id</span> <span class="n">SERIAL</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
    <span class="n">person_first</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
    <span class="n">person_last</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
    <span class="n">country_id</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
    <span class="n">FOREIGN</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">country_id</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">Country</span><span class="p">(</span><span class="n">country_id</span><span class="p">),</span>
    <span class="n">CON</span>
<span class="p">);</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
Done.
(psycopg2.errors.SyntaxError) syntax error at or near &#34;)&#34;
LINE 8: );
        ^</p>
<p>[SQL: CREATE TABLE Person (
    person_id SERIAL PRIMARY KEY,
    person_first varchar(255),
    person_last varchar(255),
    country_id varchar(2) NOT NULL,
    FOREIGN KEY (country_id) REFERENCES Country(country_id),
    CON
);]
(Background on this error at: http://sqlalche.me/e/f405)
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
View table list, either with postgres special command <code>\dt</code> or from <em>pg_catalog</em>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>
\<span class="n">dt</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
1 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>Schema</th>
        <th>Name</th>
        <th>Type</th>
        <th>Owner</th>
    </tr>
    <tr>
        <td>public</td>
        <td>country</td>
        <td>table</td>
        <td>postgres</td>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>
<span class="n">DESCRIBE</span> <span class="n">accounts</span><span class="p">;</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
(psycopg2.errors.SyntaxError) syntax error at or near &#34;DESCRIBE&#34;
LINE 1: DESCRIBE accounts;
        ^</p>
<p>[SQL: DESCRIBE accounts;]
(Background on this error at: http://sqlalche.me/e/f405)
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>
<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_tables</span>
<span class="n">WHERE</span> <span class="n">schemaname</span> <span class="o">!=</span> <span class="s1">&#39;pg_catalog&#39;</span>
<span class="n">AND</span> <span class="n">schemaname</span> <span class="o">!=</span> <span class="s1">&#39;information_schema&#39;</span><span class="p">;</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
1 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>schemaname</th>
        <th>tablename</th>
        <th>tableowner</th>
        <th>tablespace</th>
        <th>hasindexes</th>
        <th>hasrules</th>
        <th>hastriggers</th>
        <th>rowsecurity</th>
    </tr>
    <tr>
        <td>public</td>
        <td>country</td>
        <td>postgres</td>
        <td>None</td>
        <td>True</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="insert-rows">Insert rows<a class="headerlink" href="#insert-rows" title="Permanent link">&para;</a></h1>
<p></div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Country</span><span class="p">(</span><span class="n">country_id</span><span class="p">,</span> <span class="n">country_name</span><span class="p">)</span> 
<span class="n">VALUES</span> 
<span class="p">(</span><span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CU&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBA&#39;</span><span class="p">);</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
2 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
The <code>pg_relation_size()</code> function returns the size of the table only, not included indexes or additional objects.
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">SELECT</span> <span class="n">pg_size_pretty</span><span class="p">(</span><span class="n">pg_relation_size</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">));</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
1 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>pg_size_pretty</th>
    </tr>
    <tr>
        <td>8192 bytes</td>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Person</span> <span class="p">(</span><span class="n">person_first</span><span class="p">,</span> <span class="n">person_last</span><span class="p">,</span> <span class="n">country_id</span><span class="p">)</span> 
<span class="n">VALUES</span> 
<span class="p">(</span><span class="s1">&#39;Napolean&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonaparte&#39;</span><span class="p">,</span> <span class="s1">&#39;FR&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;Luis&#39;</span><span class="p">,</span><span class="s1">&#39;Alvarez&#39;</span><span class="p">,</span> <span class="s1">&#39;CU&#39;</span><span class="p">);</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
(psycopg2.errors.UndefinedTable) relation &#34;person&#34; does not exist
LINE 1: INSERT INTO Person (person_first, person_last, country_id) 
                    ^</p>
<p>[SQL: INSERT INTO Person (person_first, person_last, country_id) 
VALUES 
(&#39;Napolean&#39;, &#39;Bonaparte&#39;, &#39;FR&#39;),
(&#39;Luis&#39;,&#39;Alvarez&#39;, &#39;CU&#39;);]
(Background on this error at: http://sqlalche.me/e/f405)
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Accessing the RDBMS dictionary.
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pg_catalog</span><span class="o">.</span><span class="n">pg_tables</span>
<span class="n">WHERE</span> <span class="n">schemaname</span> <span class="o">!=</span> <span class="s1">&#39;pg_catalog&#39;</span><span class="p">;</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
8 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>schemaname</th>
        <th>tablename</th>
        <th>tableowner</th>
        <th>tablespace</th>
        <th>hasindexes</th>
        <th>hasrules</th>
        <th>hastriggers</th>
        <th>rowsecurity</th>
    </tr>
    <tr>
        <td>public</td>
        <td>country</td>
        <td>postgres</td>
        <td>None</td>
        <td>True</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_features</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_implementation_info</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_languages</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_packages</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_parts</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_sizing</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
    <tr>
        <td>information_schema</td>
        <td>sql_sizing_profiles</td>
        <td>postgres</td>
        <td>None</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
        <td>False</td>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">SELECT</span> <span class="n">sql</span> <span class="n">FROM</span> <span class="n">postgres</span> 
<span class="n">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Person&#39;</span><span class="p">;</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
(psycopg2.errors.UndefinedTable) relation &#34;postgres&#34; does not exist
LINE 1: SELECT sql FROM postgres 
                        ^</p>
<p>[SQL: SELECT sql FROM postgres 
WHERE name=&#39;Person&#39;;]
(Background on this error at: http://sqlalche.me/e/f405)
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
SQL as a Query Language.
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">SELECT</span> <span class="n">person_first</span> <span class="k">as</span> <span class="n">first</span><span class="p">,</span> <span class="n">person_last</span> <span class="n">AS</span> <span class="n">last</span><span class="p">,</span> <span class="n">country_name</span> <span class="n">AS</span> <span class="n">nationality</span>
<span class="n">FROM</span> <span class="n">Person</span> 
<span class="n">INNER</span> <span class="n">JOIN</span> <span class="n">country</span> 
<span class="n">ON</span> <span class="n">Person</span><span class="o">.</span><span class="n">country_id</span> <span class="o">=</span> <span class="n">Country</span><span class="o">.</span><span class="n">country_id</span><span class="p">;</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
(psycopg2.errors.UndefinedTable) relation &#34;person&#34; does not exist
LINE 2: FROM Person 
             ^</p>
<p>[SQL: SELECT person_first as first, person_last AS last, country_name AS nationality
FROM Person 
INNER JOIN country 
ON Person.country_id = Country.country_id;]
(Background on this error at: http://sqlalche.me/e/f405)
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Visualizing the entitry-relationship diagram (ERd).
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">ibis</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">eralchemy</span>
</code></pre></div>

</div>

<p></div>import os
from eralchemy import render_er</p>
<p>if not os.path.exists('erd_from_sqlalchemy.png'):
    render_er(uri, 'erd_from_sqlalchemy.png')
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
<img alt="" src="../erd_from_sqlalchemy.png" />
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h2 id="homework-walk-through">Homework walk-through<a class="headerlink" href="#homework-walk-through" title="Permanent link">&para;</a></h2>
<p>Convert the flat file data in <code>data/flat.csv</code> into a well-structured relational database in SQLite3 stored as <code>data/faculty.db</code>. Note - salary information is confidential and should be kept in a separate table from other personal data.
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">flat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/flat.csv&#39;</span><span class="p">,</span> <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">flat</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>gender</th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>salary</th>
      <th>nationality</th>
      <th>code</th>
      <th>country</th>
      <th>language1</th>
      <th>language2</th>
      <th>language3</th>
      <th>first</th>
      <th>last</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>915</td>
      <td>Lynwood Pope</td>
      <td>Male</td>
      <td>20</td>
      <td>1.51</td>
      <td>40</td>
      <td>88000</td>
      <td>Jordanian</td>
      <td>JO</td>
      <td>Jordan</td>
      <td>ASP</td>
      <td>Scala</td>
      <td></td>
      <td>Lynwood</td>
      <td>Pope</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Aaron Kirby</td>
      <td>Male</td>
      <td>59</td>
      <td>1.69</td>
      <td>43</td>
      <td>80000</td>
      <td>Spanish</td>
      <td>SP</td>
      <td>Spain</td>
      <td>Falcon</td>
      <td>haXe</td>
      <td>GNU Octave</td>
      <td>Aaron</td>
      <td>Kirby</td>
    </tr>
    <tr>
      <td>239</td>
      <td>Clarita Carver</td>
      <td>Female</td>
      <td>35</td>
      <td>1.66</td>
      <td>71</td>
      <td>84000</td>
      <td>Finnish</td>
      <td>FI</td>
      <td>Finland</td>
      <td>Prolog</td>
      <td>Erlang</td>
      <td>Smalltalk</td>
      <td>Clarita</td>
      <td>Carver</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>


<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
</div>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">USE</span> <span class="n">faculty</span><span class="p">;</span>
</code></pre></div>

</div>
</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com
(psycopg2.errors.SyntaxError) syntax error at or near &#34;USE&#34;
LINE 1: USE faculty;
        ^</p>
<p>[SQL: USE faculty;]
(Background on this error at: http://sqlalche.me/e/f405)
</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">Person</span><span class="p">;</span>
<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">Country</span><span class="p">;</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">Country</span> <span class="p">(</span>
    <span class="n">country_id</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
    <span class="n">country_name</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">Person</span> <span class="p">(</span>
    <span class="n">person_id</span> <span class="n">SERIAL</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
    <span class="n">name</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
    <span class="n">age</span> <span class="n">INTEGER</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
    <span class="n">country_id</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
      <span class="n">FOREIGN</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">country_id</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">Country</span><span class="p">(</span><span class="n">country_id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com/postgres
Done.
Done.
Done.
Done.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>

<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Country</span><span class="p">(</span><span class="n">country_id</span><span class="p">,</span> <span class="n">country_name</span><span class="p">)</span> 
<span class="n">VALUES</span> <span class="p">(</span><span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CU&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBA&#39;</span><span class="p">);</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com/postgres
2 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>
<span class="n">DELETE</span> <span class="n">FROM</span> <span class="n">Country</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com/postgres
2 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">sql</span>
<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">Country</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_stream output_stdout output_text">
<pre> * postgresql+psycopg2://postgres:<em>*</em>@db.postgres.app.com/postgres
0 rows affected.
</pre>
</div></p>
</div>
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<table>
    <tr>
        <th>country_id</th>
        <th>country_name</th>
    </tr>
</table>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">conn</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">flat</span><span class="o">.</span><span class="n">columns</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;name&#39;, &#39;gender&#39;, &#39;age&#39;, &#39;height&#39;, &#39;weight&#39;, &#39;salary&#39;, &#39;nationality&#39;,
       &#39;code&#39;, &#39;country&#39;, &#39;language1&#39;, &#39;language2&#39;, &#39;language3&#39;, &#39;first&#39;,
       &#39;last&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">flat</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">mapper</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">&#39;country_id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="s1">&#39;country_name&#39;</span><span class="p">},</span>
           <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">country</span> <span class="o">=</span> <span class="n">flat</span><span class="p">[[</span><span class="s1">&#39;country_id&#39;</span><span class="p">,</span> <span class="s1">&#39;country_name&#39;</span><span class="p">]]</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-31-f9749b54edd5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>country <span class="ansi-blue-fg">=</span> flat<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;country_id&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;country_name&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">   2932</span>                 key <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2933</span>             indexer = self.loc._convert_to_indexer(key, axis=1,
<span class="ansi-green-fg">-&gt; 2934</span><span class="ansi-red-fg">                                                    raise_missing=True)
</span><span class="ansi-green-intense-fg ansi-bold">   2935</span> 
<span class="ansi-green-intense-fg ansi-bold">   2936</span>         <span class="ansi-red-fg"># take() does not accept boolean indexers</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py</span> in <span class="ansi-cyan-fg">_convert_to_indexer</span><span class="ansi-blue-fg">(self, obj, axis, is_setter, raise_missing)</span>
<span class="ansi-green-intense-fg ansi-bold">   1352</span>                 kwargs = {&#39;raise_missing&#39;: True if is_setter else
<span class="ansi-green-intense-fg ansi-bold">   1353</span>                           raise_missing}
<span class="ansi-green-fg">-&gt; 1354</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_get_listlike_indexer<span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   1355</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1356</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py</span> in <span class="ansi-cyan-fg">_get_listlike_indexer</span><span class="ansi-blue-fg">(self, key, axis, raise_missing)</span>
<span class="ansi-green-intense-fg ansi-bold">   1159</span>         self._validate_read_indexer(keyarr, indexer,
<span class="ansi-green-intense-fg ansi-bold">   1160</span>                                     o<span class="ansi-blue-fg">.</span>_get_axis_number<span class="ansi-blue-fg">(</span>axis<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1161</span><span class="ansi-red-fg">                                     raise_missing=raise_missing)
</span><span class="ansi-green-intense-fg ansi-bold">   1162</span>         <span class="ansi-green-fg">return</span> keyarr<span class="ansi-blue-fg">,</span> indexer
<span class="ansi-green-intense-fg ansi-bold">   1163</span> </p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py</span> in <span class="ansi-cyan-fg">_validate_read_indexer</span><span class="ansi-blue-fg">(self, key, indexer, axis, raise_missing)</span>
<span class="ansi-green-intense-fg ansi-bold">   1244</span>                 raise KeyError(
<span class="ansi-green-intense-fg ansi-bold">   1245</span>                     u&#34;None of [{key}] are in the [{axis}]&#34;.format(
<span class="ansi-green-fg">-&gt; 1246</span><span class="ansi-red-fg">                         key=key, axis=self.obj._get_axis_name(axis)))
</span><span class="ansi-green-intense-fg ansi-bold">   1247</span> 
<span class="ansi-green-intense-fg ansi-bold">   1248</span>             <span class="ansi-red-fg"># We (temporarily) allow for some missing keys with .loc, except in</span></p>
<p><span class="ansi-red-fg">KeyError</span>: &#34;None of [Index([&#39;country_id&#39;, &#39;country_name&#39;], dtype=&#39;object&#39;)] are in the [columns]&#34;</pre>
</div>
</p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">country</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">)</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">UndefinedColumn</span>                           Traceback (most recent call last)
<span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_context</span><span class="ansi-blue-fg">(self, dialect, constructor, statement, parameters, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   1223</span>                     self.dialect.do_executemany(
<span class="ansi-green-fg">-&gt; 1224</span><span class="ansi-red-fg">                         </span>cursor<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> context
<span class="ansi-green-intense-fg ansi-bold">   1225</span>                     )</p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py</span> in <span class="ansi-cyan-fg">do_executemany</span><span class="ansi-blue-fg">(self, cursor, statement, parameters, context)</span>
<span class="ansi-green-intense-fg ansi-bold">    751</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 752</span><span class="ansi-red-fg">             </span>cursor<span class="ansi-blue-fg">.</span>executemany<span class="ansi-blue-fg">(</span>statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    753</span> </p>
<p><span class="ansi-red-fg">UndefinedColumn</span>: column &#34;country_id&#34; of relation &#34;Country&#34; does not exist
LINE 1: INSERT INTO &#34;Country&#34; (country_id, country_name) VALUES (&#39;GB...
                               ^
</p>
<p>The above exception was the direct cause of the following exception:</p>
<p><span class="ansi-red-fg">ProgrammingError</span>                          Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-103-42976342ffd9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>country<span class="ansi-blue-fg">.</span>set_index<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;country_id&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>to_sql<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Country&#39;</span><span class="ansi-blue-fg">,</span> engine<span class="ansi-blue-fg">,</span> if_exists<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;append&#39;</span><span class="ansi-blue-fg">)</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/core/generic.py</span> in <span class="ansi-cyan-fg">to_sql</span><span class="ansi-blue-fg">(self, name, con, schema, if_exists, index, index_label, chunksize, dtype, method)</span>
<span class="ansi-green-intense-fg ansi-bold">   2529</span>         sql.to_sql(self, name, con, schema=schema, if_exists=if_exists,
<span class="ansi-green-intense-fg ansi-bold">   2530</span>                    index<span class="ansi-blue-fg">=</span>index<span class="ansi-blue-fg">,</span> index_label<span class="ansi-blue-fg">=</span>index_label<span class="ansi-blue-fg">,</span> chunksize<span class="ansi-blue-fg">=</span>chunksize<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 2531</span><span class="ansi-red-fg">                    dtype=dtype, method=method)
</span><span class="ansi-green-intense-fg ansi-bold">   2532</span> 
<span class="ansi-green-intense-fg ansi-bold">   2533</span>     def to_pickle(self, path, compression=&#39;infer&#39;,</p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/io/sql.py</span> in <span class="ansi-cyan-fg">to_sql</span><span class="ansi-blue-fg">(frame, name, con, schema, if_exists, index, index_label, chunksize, dtype, method)</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span>     pandas_sql.to_sql(frame, name, if_exists=if_exists, index=index,
<span class="ansi-green-intense-fg ansi-bold">    459</span>                       index_label<span class="ansi-blue-fg">=</span>index_label<span class="ansi-blue-fg">,</span> schema<span class="ansi-blue-fg">=</span>schema<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 460</span><span class="ansi-red-fg">                       chunksize=chunksize, dtype=dtype, method=method)
</span><span class="ansi-green-intense-fg ansi-bold">    461</span> 
<span class="ansi-green-intense-fg ansi-bold">    462</span> </p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/io/sql.py</span> in <span class="ansi-cyan-fg">to_sql</span><span class="ansi-blue-fg">(self, frame, name, if_exists, index, index_label, schema, chunksize, dtype, method)</span>
<span class="ansi-green-intense-fg ansi-bold">   1172</span>                          schema=schema, dtype=dtype)
<span class="ansi-green-intense-fg ansi-bold">   1173</span>         table<span class="ansi-blue-fg">.</span>create<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1174</span><span class="ansi-red-fg">         </span>table<span class="ansi-blue-fg">.</span>insert<span class="ansi-blue-fg">(</span>chunksize<span class="ansi-blue-fg">,</span> method<span class="ansi-blue-fg">=</span>method<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1175</span>         <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">(</span><span class="ansi-green-fg">not</span> name<span class="ansi-blue-fg">.</span>isdigit<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> name<span class="ansi-blue-fg">.</span>islower<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1176</span>             <span class="ansi-red-fg"># check for potentially case sensitivity issues (GH7815)</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/io/sql.py</span> in <span class="ansi-cyan-fg">insert</span><span class="ansi-blue-fg">(self, chunksize, method)</span>
<span class="ansi-green-intense-fg ansi-bold">    684</span> 
<span class="ansi-green-intense-fg ansi-bold">    685</span>                 chunk_iter <span class="ansi-blue-fg">=</span> zip<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">[</span>arr<span class="ansi-blue-fg">[</span>start_i<span class="ansi-blue-fg">:</span>end_i<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> arr <span class="ansi-green-fg">in</span> data_list<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 686</span><span class="ansi-red-fg">                 </span>exec_insert<span class="ansi-blue-fg">(</span>conn<span class="ansi-blue-fg">,</span> keys<span class="ansi-blue-fg">,</span> chunk_iter<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    687</span> 
<span class="ansi-green-intense-fg ansi-bold">    688</span>     def _query_iterator(self, result, chunksize, columns, coerce_float=True,</p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/pandas/io/sql.py</span> in <span class="ansi-cyan-fg">_execute_insert</span><span class="ansi-blue-fg">(self, conn, keys, data_iter)</span>
<span class="ansi-green-intense-fg ansi-bold">    597</span>         &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    598</span>         data <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>dict<span class="ansi-blue-fg">(</span>zip<span class="ansi-blue-fg">(</span>keys<span class="ansi-blue-fg">,</span> row<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> row <span class="ansi-green-fg">in</span> data_iter<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 599</span><span class="ansi-red-fg">         </span>conn<span class="ansi-blue-fg">.</span>execute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>table<span class="ansi-blue-fg">.</span>insert<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    600</span> 
<span class="ansi-green-intense-fg ansi-bold">    601</span>     <span class="ansi-green-fg">def</span> _execute_insert_multi<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> conn<span class="ansi-blue-fg">,</span> keys<span class="ansi-blue-fg">,</span> data_iter<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">execute</span><span class="ansi-blue-fg">(self, object_, *multiparams, **params)</span>
<span class="ansi-green-intense-fg ansi-bold">    986</span>             <span class="ansi-green-fg">raise</span> exc<span class="ansi-blue-fg">.</span>ObjectNotExecutableError<span class="ansi-blue-fg">(</span>object_<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    987</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 988</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> meth<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> multiparams<span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    989</span> 
<span class="ansi-green-intense-fg ansi-bold">    990</span>     <span class="ansi-green-fg">def</span> _execute_function<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> func<span class="ansi-blue-fg">,</span> multiparams<span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/sql/elements.py</span> in <span class="ansi-cyan-fg">_execute_on_connection</span><span class="ansi-blue-fg">(self, connection, multiparams, params)</span>
<span class="ansi-green-intense-fg ansi-bold">    285</span>     <span class="ansi-green-fg">def</span> _execute_on_connection<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> connection<span class="ansi-blue-fg">,</span> multiparams<span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>supports_execution<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 287</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> connection<span class="ansi-blue-fg">.</span>_execute_clauseelement<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> multiparams<span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    288</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>             <span class="ansi-green-fg">raise</span> exc<span class="ansi-blue-fg">.</span>ObjectNotExecutableError<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_clauseelement</span><span class="ansi-blue-fg">(self, elem, multiparams, params)</span>
<span class="ansi-green-intense-fg ansi-bold">   1105</span>             distilled_params<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1106</span>             compiled_sql<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1107</span><span class="ansi-red-fg">             </span>distilled_params<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1108</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1109</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_has_events <span class="ansi-green-fg">or</span> self<span class="ansi-blue-fg">.</span>engine<span class="ansi-blue-fg">.</span>_has_events<span class="ansi-blue-fg">:</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_context</span><span class="ansi-blue-fg">(self, dialect, constructor, statement, parameters, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   1246</span>         <span class="ansi-green-fg">except</span> BaseException <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1247</span>             self._handle_dbapi_exception(
<span class="ansi-green-fg">-&gt; 1248</span><span class="ansi-red-fg">                 </span>e<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> cursor<span class="ansi-blue-fg">,</span> context
<span class="ansi-green-intense-fg ansi-bold">   1249</span>             )
<span class="ansi-green-intense-fg ansi-bold">   1250</span> </p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_handle_dbapi_exception</span><span class="ansi-blue-fg">(self, e, statement, parameters, cursor, context)</span>
<span class="ansi-green-intense-fg ansi-bold">   1464</span>                 util<span class="ansi-blue-fg">.</span>raise_from_cause<span class="ansi-blue-fg">(</span>newraise<span class="ansi-blue-fg">,</span> exc_info<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1465</span>             <span class="ansi-green-fg">elif</span> should_wrap<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1466</span><span class="ansi-red-fg">                 </span>util<span class="ansi-blue-fg">.</span>raise_from_cause<span class="ansi-blue-fg">(</span>sqlalchemy_exception<span class="ansi-blue-fg">,</span> exc_info<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1467</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1468</span>                 util<span class="ansi-blue-fg">.</span>reraise<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>exc_info<span class="ansi-blue-fg">)</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/util/compat.py</span> in <span class="ansi-cyan-fg">raise_from_cause</span><span class="ansi-blue-fg">(exception, exc_info)</span>
<span class="ansi-green-intense-fg ansi-bold">    381</span>     exc_type<span class="ansi-blue-fg">,</span> exc_value<span class="ansi-blue-fg">,</span> exc_tb <span class="ansi-blue-fg">=</span> exc_info
<span class="ansi-green-intense-fg ansi-bold">    382</span>     cause <span class="ansi-blue-fg">=</span> exc_value <span class="ansi-green-fg">if</span> exc_value <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> exception <span class="ansi-green-fg">else</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">--&gt; 383</span><span class="ansi-red-fg">     </span>reraise<span class="ansi-blue-fg">(</span>type<span class="ansi-blue-fg">(</span>exception<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> exception<span class="ansi-blue-fg">,</span> tb<span class="ansi-blue-fg">=</span>exc_tb<span class="ansi-blue-fg">,</span> cause<span class="ansi-blue-fg">=</span>cause<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    384</span> 
<span class="ansi-green-intense-fg ansi-bold">    385</span> </p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/util/compat.py</span> in <span class="ansi-cyan-fg">reraise</span><span class="ansi-blue-fg">(tp, value, tb, cause)</span>
<span class="ansi-green-intense-fg ansi-bold">    126</span>             value<span class="ansi-blue-fg">.</span>__cause__ <span class="ansi-blue-fg">=</span> cause
<span class="ansi-green-intense-fg ansi-bold">    127</span>         <span class="ansi-green-fg">if</span> value<span class="ansi-blue-fg">.</span>__traceback__ <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> tb<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 128</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> value<span class="ansi-blue-fg">.</span>with_traceback<span class="ansi-blue-fg">(</span>tb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span>         <span class="ansi-green-fg">raise</span> value
<span class="ansi-green-intense-fg ansi-bold">    130</span> </p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/engine/base.py</span> in <span class="ansi-cyan-fg">_execute_context</span><span class="ansi-blue-fg">(self, dialect, constructor, statement, parameters, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">   1222</span>                 <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> evt_handled<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1223</span>                     self.dialect.do_executemany(
<span class="ansi-green-fg">-&gt; 1224</span><span class="ansi-red-fg">                         </span>cursor<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">,</span> context
<span class="ansi-green-intense-fg ansi-bold">   1225</span>                     )
<span class="ansi-green-intense-fg ansi-bold">   1226</span>             <span class="ansi-green-fg">elif</span> <span class="ansi-green-fg">not</span> parameters <span class="ansi-green-fg">and</span> context<span class="ansi-blue-fg">.</span>no_parameters<span class="ansi-blue-fg">:</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py</span> in <span class="ansi-cyan-fg">do_executemany</span><span class="ansi-blue-fg">(self, cursor, statement, parameters, context)</span>
<span class="ansi-green-intense-fg ansi-bold">    750</span>             extras<span class="ansi-blue-fg">.</span>execute_batch<span class="ansi-blue-fg">(</span>cursor<span class="ansi-blue-fg">,</span> statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    751</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 752</span><span class="ansi-red-fg">             </span>cursor<span class="ansi-blue-fg">.</span>executemany<span class="ansi-blue-fg">(</span>statement<span class="ansi-blue-fg">,</span> parameters<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    753</span> 
<span class="ansi-green-intense-fg ansi-bold">    754</span>     <span class="ansi-blue-fg">@</span>util<span class="ansi-blue-fg">.</span>memoized_instancemethod</p>
<p><span class="ansi-red-fg">ProgrammingError</span>: (psycopg2.errors.UndefinedColumn) column &#34;country_id&#34; of relation &#34;Country&#34; does not exist
LINE 1: INSERT INTO &#34;Country&#34; (country_id, country_name) VALUES (&#39;GB...
                               ^</p>
<p>[SQL: INSERT INTO &#34;Country&#34; (country_id, country_name) VALUES (%(country_id)s, %(country_name)s)]
[parameters: ({&#39;country_id&#39;: &#39;GB&#39;, &#39;country_name&#39;: &#39;United Kingdom&#39;}, {&#39;country_id&#39;: &#39;SP&#39;, &#39;country_name&#39;: &#39;Spain&#39;}, {&#39;country_id&#39;: &#39;IT&#39;, &#39;country_name&#39;: &#39;Italy&#39;}, {&#39;country_id&#39;: &#39;IT&#39;, &#39;country_name&#39;: &#39;Italy&#39;}, {&#39;country_id&#39;: &#39;UY&#39;, &#39;country_name&#39;: &#39;Uruguay&#39;}, {&#39;country_id&#39;: &#39;CM&#39;, &#39;country_name&#39;: &#39;Cambodia&#39;}, {&#39;country_id&#39;: &#39;CM&#39;, &#39;country_name&#39;: &#39;Cameroon&#39;}, {&#39;country_id&#39;: &#39;BE&#39;, &#39;country_name&#39;: &#39;Belgium&#39;}  ... displaying 10 of 1523 total bound parameter sets ...  {&#39;country_id&#39;: &#39;ET&#39;, &#39;country_name&#39;: &#39;Ethiopia&#39;}, {&#39;country_id&#39;: &#39;VE&#39;, &#39;country_name&#39;: &#39;Venezuela&#39;})]
(Background on this error at: http://sqlalche.me/e/f405)</pre>
</div></p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="sql">%%sql<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h1>
<p>SELECT * FROM Country
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">flat</span><span class="o">.</span><span class="n">to_sql</span><span class="err">?</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Signature:</span>
flat<span class="ansi-blue-fg">.</span>to_sql<span class="ansi-blue-fg">(</span>
    name<span class="ansi-blue-fg">,</span>
    con<span class="ansi-blue-fg">,</span>
    schema<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    if_exists<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;fail&#39;</span><span class="ansi-blue-fg">,</span>
    index<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    index_label<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    chunksize<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    method<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Write records stored in a DataFrame to a SQL database.

Databases supported by SQLAlchemy [1]_ are supported. Tables can be
newly created, appended to, or overwritten.

Parameters
----------
name : string
    Name of SQL table.
con : sqlalchemy.engine.Engine or sqlite3.Connection
    Using SQLAlchemy makes it possible to use any DB supported by that
    library. Legacy support is provided for sqlite3.Connection objects.
schema : string, optional
    Specify the schema (if database flavor supports this). If None, use
    default schema.
if_exists : {&#39;fail&#39;, &#39;replace&#39;, &#39;append&#39;}, default &#39;fail&#39;
    How to behave if the table already exists.

    * fail: Raise a ValueError.
    * replace: Drop the table before inserting new values.
    * append: Insert new values to the existing table.

index : bool, default True
    Write DataFrame index as a column. Uses `index_label` as the column
    name in the table.
index_label : string or sequence, default None
    Column label for index column(s). If None is given (default) and
    `index` is True, then the index names are used.
    A sequence should be given if the DataFrame uses MultiIndex.
chunksize : int, optional
    Rows will be written in batches of this size at a time. By default,
    all rows will be written at once.
dtype : dict, optional
    Specifying the datatype for columns. The keys should be the column
    names and the values should be the SQLAlchemy types or strings for
    the sqlite3 legacy mode.
method : {None, &#39;multi&#39;, callable}, default None
    Controls the SQL insertion clause used:

    * None : Uses standard SQL ``INSERT`` clause (one per row).
    * &#39;multi&#39;: Pass multiple values in a single ``INSERT`` clause.
    * callable with signature ``(pd_table, conn, keys, data_iter)``.

    Details and a sample callable implementation can be found in the
    section :ref:`insert method &lt;io.sql.method&gt;`.

    .. versionadded:: 0.24.0

Raises
------
ValueError
    When the table already exists and `if_exists` is &#39;fail&#39; (the
    default).

See Also
--------
read_sql : Read a DataFrame from a table.

Notes
-----
Timezone aware datetime columns will be written as
``Timestamp with timezone`` type with SQLAlchemy if supported by the
database. Otherwise, the datetimes will be stored as timezone unaware
timestamps local to the original timezone.

.. versionadded:: 0.24.0

References
----------
.. [1] http://docs.sqlalchemy.org
.. [2] https://www.python.org/dev/peps/pep-0249/

Examples
--------

Create an in-memory SQLite database.

&gt;&gt;&gt; from sqlalchemy import create_engine
&gt;&gt;&gt; engine = create_engine(&#39;sqlite://&#39;, echo=False)

Create a table from scratch with 3 rows.

&gt;&gt;&gt; df = pd.DataFrame({&#39;name&#39; : [&#39;User 1&#39;, &#39;User 2&#39;, &#39;User 3&#39;]})
&gt;&gt;&gt; df
     name
0  User 1
1  User 2
2  User 3

&gt;&gt;&gt; df.to_sql(&#39;users&#39;, con=engine)
&gt;&gt;&gt; engine.execute(&#34;SELECT * FROM users&#34;).fetchall()
[(0, &#39;User 1&#39;), (1, &#39;User 2&#39;), (2, &#39;User 3&#39;)]

&gt;&gt;&gt; df1 = pd.DataFrame({&#39;name&#39; : [&#39;User 4&#39;, &#39;User 5&#39;]})
&gt;&gt;&gt; df1.to_sql(&#39;users&#39;, con=engine, if_exists=&#39;append&#39;)
&gt;&gt;&gt; engine.execute(&#34;SELECT * FROM users&#34;).fetchall()
[(0, &#39;User 1&#39;), (1, &#39;User 2&#39;), (2, &#39;User 3&#39;),
 (0, &#39;User 4&#39;), (1, &#39;User 5&#39;)]

Overwrite the table with just ``df1``.

&gt;&gt;&gt; df1.to_sql(&#39;users&#39;, con=engine, if_exists=&#39;replace&#39;,
...            index_label=&#39;id&#39;)
&gt;&gt;&gt; engine.execute(&#34;SELECT * FROM users&#34;).fetchall()
[(0, &#39;User 4&#39;), (1, &#39;User 5&#39;)]

Specify the dtype (especially useful for integers with missing values).
Notice that while pandas is forced to store the data as floating point,
the database supports nullable integers. When fetching the data with
Python, we get back integer scalars.

&gt;&gt;&gt; df = pd.DataFrame({&#34;A&#34;: [1, None, 2]})
&gt;&gt;&gt; df
     A
0  1.0
1  NaN
2  2.0

&gt;&gt;&gt; from sqlalchemy.types import Integer
&gt;&gt;&gt; df.to_sql(&#39;integers&#39;, con=engine, index=False,
...           dtype={&#34;A&#34;: Integer()})

&gt;&gt;&gt; engine.execute(&#34;SELECT * FROM integers&#34;).fetchall()
[(1,), (None,), (2,)]
<span class="ansi-red-fg">File:</span>      /opt/conda/lib/python3.7/site-packages/pandas/core/generic.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>

</div>


<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">coro</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;running </span><span class="si">{</span><span class="nb">int</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;continuing </span><span class="si">{</span><span class="nb">int</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span>
</code></pre></div>

</div>

<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">coro</span><span class="p">)</span>
</code></pre></div>

</div>

<div class="output_wrapper">
<div class="output" markdown="1">

<div class="output_area">
<p><div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-109-550412da50e5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>asyncio<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>coro<span class="ansi-blue-fg">)</span></p>
<p><span class="ansi-green-fg">/opt/conda/lib/python3.7/asyncio/runners.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(main, debug)</span>
<span class="ansi-green-intense-fg ansi-bold">     32</span>     <span class="ansi-green-fg">if</span> events<span class="ansi-blue-fg">.</span>_get_running_loop<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span>         raise RuntimeError(
<span class="ansi-green-fg">---&gt; 34</span><span class="ansi-red-fg">             &#34;asyncio.run() cannot be called from a running event loop&#34;)
</span><span class="ansi-green-intense-fg ansi-bold">     35</span> 
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> coroutines<span class="ansi-blue-fg">.</span>iscoroutine<span class="ansi-blue-fg">(</span>main<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span></p>
<p><span class="ansi-red-fg">RuntimeError</span>: asyncio.run() cannot be called from a running event loop</pre>
</div>
</p>
</div>
</div>


</div>
<p></div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input"></p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>

</div>

</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  <!--  -->
  <!-- <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div> -->
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: ["tabs", "instant"],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../../_js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/treant-js/1.0/Treant.min.js"></script>
      
        <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
      
    
  </body>
</html>